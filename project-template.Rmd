---
title: "Your Project Title (be descriptive and creative!)"
author: "Group 35: Max Ming Yi Koh (1007972785) and Kevin Le (1007952805)"
date: March 31, 2022
output: 
  beamer_presentation:
    theme: "Pittsburgh"
    colortheme: "orchid"
    fonttheme: "structurebold"
    slide_level: 2
classoption: "aspectratio=169"
fontsize: 11pt
urlcolor: blue
---


```{r, echo=FALSE, message=FALSE, warning=FALSE}
# echo=FALSE will stop the code chunk from appearing in the knit document
# warning=FALSE and message=FALSE will stop R messages from appearing in the knit document
library(tidyverse)
library(dplyr)
# here is the data for this project
expedia_data <- read_csv("ExpediaSearchData.csv")
glimpse(expedia_data)
# see the Project Overview page for more information: 
# https://q.utoronto.ca/courses/235890/pages/project-overview
```

## Overall Introductions

## Data Summary

## Research Question 1
Does urgency affect how much consumers are willing to pay? 

--- 
# TODO: Add visualization 
```{r}
expedia_data_q1 <- expedia_data %>% 
  select(is_trans1, is_trans2, is_trans3, price_bucket1, price_bucket2, price_bucket3, 
         checkin_date, search_timestamp, destination_id) %>% 
  filter(is_trans1 + is_trans2 + is_trans3 == 1 & 
           !is.na(checkin_date) & !is.na(search_timestamp) & !is.na(destination_id)) %>%
  mutate(
    price_bucket1 = ifelse(is.na(is_trans1) | is_trans1 == 0, 0, price_bucket1),
    price_bucket2 = ifelse(is.na(is_trans2) | is_trans2 == 0, 0, price_bucket2),
    price_bucket3 = ifelse(is.na(is_trans3) | is_trans3 == 0, 0, price_bucket2),
    price_bucket = (price_bucket1 + price_bucket2 + price_bucket3) / (is_trans1 + is_trans2 + is_trans3),
    search_timestamp = as.Date(as.character(search_timestamp)))
expedia_data_q1 %>% ggplot(aes(x=checkin_date - search_timestamp, y=price_bucket)) + 
	geom_point() + 
	labs(x = "TODO: add x-axis label", 
		   y = "TODO: add y-axis label", 
		   title = "TODO: add title") + 
	geom_smooth(method="lm", se=FALSE) + 
	theme_minimal() 
```

--- 
# TODO: Set up statistical model 
```{r}
expedia_data_q2 <- expedia_data %>% 
  select(is_trans1, is_trans2, is_trans3, price_bucket1, price_bucket2, price_bucket3, 
         checkin_date, search_timestamp, destination_id) %>% 
  filter(is_trans1 + is_trans2 + is_trans3 == 1 & 
           !is.na(checkin_date) & !is.na(search_timestamp) & !is.na(destination_id)) %>%
  mutate(
    price_bucket1 = ifelse(is.na(is_trans1) | is_trans1 == 0, 0, price_bucket1),
    price_bucket2 = ifelse(is.na(is_trans2) | is_trans2 == 0, 0, price_bucket2),
    price_bucket3 = ifelse(is.na(is_trans3) | is_trans3 == 0, 0, price_bucket2),
    price_bucket = (price_bucket1 + price_bucket2 + price_bucket3) / (is_trans1 + is_trans2 + is_trans3),
    search_timestamp = as.Date(as.character(search_timestamp)))
expedia_data_q1 %>% ggplot(aes(x=checkin_date - search_timestamp, y=price_bucket)) + 
	geom_point() + 
	labs(x = "TODO: add x-axis label", 
		   y = "TODO: add y-axis label", 
		   title = "TODO: add title") + 
	geom_smooth(method="lm", se=FALSE) + 
	theme_minimal() 
```

--- 
# TODO: Analyze results from statistical model 
- lack of consumers who transacted one of the first 3 listings. This limits the # of data points available to 9 datapoints. 
- from the linear regression model, we observe that there is a very weak negative association between [var1] and [var2] 
- The p-value calculated is 0.384 > 0.1 which implies there is no evidence against the null hypothesis that ... 
- We can conclude that urgency does not affect the price bucket 
- However, this result can still be further explored in the future for 2 reasons 
  ~ 9 data points out of a sample of 1000 users on a site like Expedia is not representative of the population (need to track      all users that transacted some property)
  ~ Originally, we planned to separate analysis by desinations to avoid pricing disparity due to different locations . However,     the remaining 9 destinations are all from different desination_id's. So, it is possible that the different locations
    resulted is the lack of correlation / strength of association. 

## Research Question 2 
Are properties with discounted prices more likely to be sold? 

Motivation of research question: 

--- 
# TODO: Add visualization 

--- 
# TODO: Set up statistical model 
```{r}

```

--- 
# TODO: Analyze results from statistical model 

## Research Question 3 
Do the number of infants, children and adults affect the length of travel?

--- 
# TODO: Add visualization 
```{r}
expedia_data_q3 <- expedia_data %>% select(search_timestamp, adult_count, child_count, infant_count, checkin_date) %>% filter(!is.na(checkin_date) & !is.na(search_timestamp)) %>% mutate(travel_length = as.numeric(as.Date(as.character(checkin_date)) - as.Date(as.character(search_timestamp))))

glimpse(expedia_data_q3)

expedia_data_q3 %>% ggplot(aes(x=child_count, y= travel_length)) + 
  geom_point() +
  labs(x="number of children",
       y="length of travel (days)",
       title = "TODO: add title") +
  theme_minimal()

expedia_data_q3 %>% ggplot(aes(x=adult_count, y= travel_length)) + 
  geom_point() +
  geom_smooth(se=FALSE, method="lm") +
  labs(x="number of adults",
       y="length of travel (days)",
       title = "TODO: add title") +
  theme_minimal()

expedia_data_q3 %>% ggplot(aes(x=infant_count, y=travel_length)) + 
  geom_point() +
  geom_smooth(se=FALSE, method="lm") +
  labs(x="number of infants",
       y="length of travel (days)",
       title = "TODO: add title") +
  theme_minimal()
```

--- 
# TODO: Set up statistical model 
```{r}
model_child <- lm(travel_length ~ child_count, data = expedia_data_q3) 

summary(model_child)$coefficients


model_adult <- lm(travel_length ~ adult_count, data = expedia_data_q3) 

summary(model_adult)$coefficients

model_infant <- lm(travel_length ~ infant_count, data = expedia_data_q3) 


summary(model_infant)$coefficients

```

--- 
# TODO: Analyze results from statistical model 

- variation of data is weak as 90% of the dataset are with searchs with no children/ infants
- p-value for the child_count model is approximately 0.563 which suggests that there is weak evidence against the null hypothesis 
- p-value for the adult_count model is relatively small (p-value < 5.393e-08) which suggests very strong evidience against the null hypothesis
- p-value for the infant_count model is relatively small (p-value < 1.393e-02) which suggests strong evidience against the null hypothesis
   ~ more onto the infant sample, it is noticed that only 2 searches have infants in their group which causes small generalizations to be yield here
- we can conclude that the number of adults will lead to greater travel lengths


## Limitations 

## Overall Conclusion